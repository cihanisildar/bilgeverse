generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model EventType {
  id          String   @id @default(uuid())
  name        String   @unique
  description String?
  isActive    Boolean  @default(true)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  events      Event[]  @relation("EventTypeEvents")
}

model Period {
  id                     String                  @id @default(uuid())
  name                   String                  @unique
  description            String?
  startDate              DateTime
  endDate                DateTime?
  status                 PeriodStatus            @default(INACTIVE)
  createdAt              DateTime                @default(now())
  updatedAt              DateTime                @updatedAt
  totalWeeks             Int                     @default(8)
  announcements          Announcement[]          @relation("PeriodAnnouncements")
  events                 Event[]                 @relation("PeriodEvents")
  experienceTransactions ExperienceTransaction[] @relation("PeriodExperienceTransactions")
  itemRequests           ItemRequest[]           @relation("PeriodItemRequests")
  pointsTransactions     PointsTransaction[]     @relation("PeriodPointsTransactions")
  studentNotes           StudentNote[]           @relation("PeriodStudentNotes")
  studentReports         StudentReport[]         @relation("PeriodStudentReports")
  rollbacks              TransactionRollback[]   @relation("PeriodRollbacks")
  weeklyReports          WeeklyReport[]          @relation("PeriodWeeklyReports")
  wishes                 Wish[]                  @relation("PeriodWishes")

  @@index([status])
}

model User {
  id                            String                    @id @default(cuid())
  username                      String                    @unique
  email                         String                    @unique
  password                      String
  role                          UserRole
  points                        Int                       @default(0)
  firstName                     String?
  lastName                      String?
  createdAt                     DateTime                  @default(now())
  updatedAt                     DateTime                  @updatedAt
  avatarUrl                     String?
  experience                    Int                       @default(0)
  bio                           String?
  phone                         String?
  preferences                   Json?
  specialization                String?
  tutorId                       String?
  studentClassroomId            String?
  assistedTutorId               String?
  isActive                      Boolean                   @default(true)
  statusChangedAt               DateTime?
  statusChangedBy               String?
  absenceNotificationsAsStudent AbsenceNotification[]     @relation("StudentAbsenceNotifications")
  absenceNotificationsAsTutor   AbsenceNotification[]     @relation("TutorAbsenceNotifications")
  createdAnnouncements          Announcement[]            @relation("AdminAnnouncements")
  createdSessions               AttendanceSession[]       @relation("SessionCreator")
  boardMember                   BoardMember?              @relation("BoardMemberUser")
  classroom                     Classroom?                @relation("ClassroomTutor")
  responsibleDecisions          DecisionResponsibleUser[] @relation("DecisionResponsible")
  createdEvents                 Event[]                   @relation("EventCreator")
  eventsForTutor                Event[]                   @relation("TutorEvents")
  eventParticipations           EventParticipant[]        @relation("UserParticipations")
  experienceReceived            ExperienceTransaction[]   @relation("StudentExperience")
  experienceGiven               ExperienceTransaction[]   @relation("TutorExperience")
  studentRequests               ItemRequest[]             @relation("StudentRequests")
  tutorApprovals                ItemRequest[]             @relation("TutorApprovals")
  createdMeetings               ManagerMeeting[]          @relation("MeetingCreator")
  meetingAttendances            MeetingAttendance[]       @relation("UserAttendances")
  notifications                 Notification[]            @relation("UserNotifications")
  createdPart2Events            Part2Event[]              @relation("Part2EventCreator")
  part2EventParticipations      Part2EventParticipant[]   @relation("Part2EventParticipations")
  uploadedPdfs                  PartPdf[]                 @relation("UploadedPdfs")
  createdCards                  PointEarningCard[]        @relation("AdminCards")
  createdReasons                PointReason[]             @relation("AdminReasons")
  studentPoints                 PointsTransaction[]       @relation("StudentPoints")
  tutorPoints                   PointsTransaction[]       @relation("TutorPoints")
  processedRegistrations        RegistrationRequest[]
  studentAttendances            StudentAttendance[]       @relation("StudentAttendances")
  studentNotes                  StudentNote[]             @relation("StudentNotes")
  tutorNotes                    StudentNote[]             @relation("TutorNotes")
  studentReports                StudentReport[]           @relation("StudentReports")
  tutorReports                  StudentReport[]           @relation("TutorReports")
  createdSyllabi                Syllabus[]                @relation("TutorSyllabi")
  rollbacksAsAdmin              TransactionRollback[]     @relation("RollbackAdmin")
  rollbacksAsStudent            TransactionRollback[]     @relation("RollbackStudent")
  assistedTutor                 User?                     @relation("AsistanTutor", fields: [assistedTutorId], references: [id])
  asistans                      User[]                    @relation("AsistanTutor")
  classroomStudents             Classroom?                @relation("ClassroomStudents", fields: [studentClassroomId], references: [id])
  tutor                         User?                     @relation("TutorStudents", fields: [tutorId], references: [id])
  students                      User[]                    @relation("TutorStudents")
  reviewedReports               WeeklyReport[]            @relation("AdminReviewedReports")
  weeklyReports                 WeeklyReport[]            @relation("UserWeeklyReports")
  createdQuestions              WeeklyReportQuestion[]    @relation("AdminQuestions")
  wishes                        Wish[]                    @relation("StudentWishes")
  meslekkocuId                  String?

  @@index([tutorId])
}

model Classroom {
  id             String                    @id @default(uuid())
  name           String                    @default("Sınıf")
  description    String?                   @default("Öğretmen ve öğrencileri")
  createdAt      DateTime                  @default(now())
  updatedAt      DateTime                  @updatedAt
  tutorId        String                    @unique
  tutor          User                      @relation("ClassroomTutor", fields: [tutorId], references: [id])
  students       User[]                    @relation("ClassroomStudents")
  lessonProgress ClassroomLessonProgress[] @relation("ClassroomLessonProgress")
}

model Event {
  id                String             @id @default(uuid())
  title             String
  description       String
  startDateTime     DateTime
  endDateTime       DateTime?
  location          String             @default("Online")
  capacity          Int                @default(20)
  points            Int                @default(0)
  tags              String[]
  status            EventStatus        @default(YAKINDA)
  eventScope        EventScope         @default(GROUP)
  createdAt         DateTime           @default(now())
  updatedAt         DateTime           @updatedAt
  createdById       String
  createdForTutorId String?
  experience        Int                @default(0)
  periodId          String
  customName        String?
  eventTypeId       String
  createdBy         User               @relation("EventCreator", fields: [createdById], references: [id])
  createdForTutor   User?              @relation("TutorEvents", fields: [createdForTutorId], references: [id])
  eventType         EventType          @relation("EventTypeEvents", fields: [eventTypeId], references: [id])
  period            Period             @relation("PeriodEvents", fields: [periodId], references: [id])
  participants      EventParticipant[] @relation("EventParticipations")

  @@index([periodId])
}

model EventParticipant {
  id           String            @id @default(uuid())
  status       ParticipantStatus @default(REGISTERED)
  registeredAt DateTime          @default(now())
  updatedAt    DateTime          @updatedAt
  eventId      String
  userId       String
  event        Event             @relation("EventParticipations", fields: [eventId], references: [id], onDelete: Cascade)
  user         User              @relation("UserParticipations", fields: [userId], references: [id], onDelete: Cascade)

  @@unique([eventId, userId])
}

model StoreItem {
  id             String        @id @default(uuid())
  name           String        @unique
  description    String
  pointsRequired Int
  imageUrl       String?
  createdAt      DateTime      @default(now())
  updatedAt      DateTime      @updatedAt
  itemRequests   ItemRequest[]
}

model RegistrationRequest {
  id              String        @id @default(uuid())
  username        String
  email           String
  password        String
  firstName       String?
  lastName        String?
  requestedRole   UserRole      @default(STUDENT)
  status          RequestStatus @default(PENDING)
  rejectionReason String?
  createdAt       DateTime      @default(now())
  updatedAt       DateTime      @updatedAt
  processedById   String?
  processedBy     User?         @relation(fields: [processedById], references: [id])
}

model ItemRequest {
  id          String        @id @default(uuid())
  status      RequestStatus @default(PENDING)
  pointsSpent Int
  note        String?
  createdAt   DateTime      @default(now())
  updatedAt   DateTime      @updatedAt
  studentId   String
  tutorId     String
  itemId      String
  periodId    String
  item        StoreItem     @relation(fields: [itemId], references: [id])
  period      Period        @relation("PeriodItemRequests", fields: [periodId], references: [id])
  student     User          @relation("StudentRequests", fields: [studentId], references: [id])
  tutor       User          @relation("TutorApprovals", fields: [tutorId], references: [id])

  @@index([periodId])
}

model PointsTransaction {
  id            String          @id @default(uuid())
  points        Int
  type          TransactionType
  reason        String?
  createdAt     DateTime        @default(now())
  updatedAt     DateTime        @updatedAt
  studentId     String
  tutorId       String
  pointReasonId String?
  rolledBack    Boolean         @default(false)
  periodId      String
  period        Period          @relation("PeriodPointsTransactions", fields: [periodId], references: [id])
  pointReason   PointReason?    @relation("ReasonTransactions", fields: [pointReasonId], references: [id])
  student       User            @relation("StudentPoints", fields: [studentId], references: [id])
  tutor         User            @relation("TutorPoints", fields: [tutorId], references: [id])

  @@index([periodId])
}

model ExperienceTransaction {
  id         String   @id @default(uuid())
  amount     Int
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt
  studentId  String
  tutorId    String
  rolledBack Boolean  @default(false)
  periodId   String
  period     Period   @relation("PeriodExperienceTransactions", fields: [periodId], references: [id])
  student    User     @relation("StudentExperience", fields: [studentId], references: [id])
  tutor      User     @relation("TutorExperience", fields: [tutorId], references: [id])

  @@index([periodId])
}

model Wish {
  id          String    @id @default(uuid())
  title       String
  description String
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt
  studentId   String
  respondedAt DateTime?
  respondedBy String?
  response    String?
  periodId    String
  period      Period    @relation("PeriodWishes", fields: [periodId], references: [id])
  student     User      @relation("StudentWishes", fields: [studentId], references: [id])

  @@index([periodId])
}

model StudentNote {
  id        String   @id @default(cuid())
  content   String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  studentId String
  tutorId   String
  periodId  String
  period    Period   @relation("PeriodStudentNotes", fields: [periodId], references: [id])
  student   User     @relation("StudentNotes", fields: [studentId], references: [id])
  tutor     User     @relation("TutorNotes", fields: [tutorId], references: [id])

  @@index([studentId])
  @@index([tutorId])
  @@index([periodId])
}

model StudentReport {
  id        String   @id @default(cuid())
  title     String
  content   String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  studentId String
  tutorId   String
  periodId  String
  period    Period   @relation("PeriodStudentReports", fields: [periodId], references: [id])
  student   User     @relation("StudentReports", fields: [studentId], references: [id])
  tutor     User     @relation("TutorReports", fields: [tutorId], references: [id])

  @@index([studentId])
  @@index([tutorId])
  @@index([periodId])
}

model PointEarningCard {
  id          String   @id @default(uuid())
  title       String
  description String
  points      Int
  icon        String?
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  isActive    Boolean  @default(true)
  createdById String
  maxPoints   Int?
  minPoints   Int?
  createdBy   User     @relation("AdminCards", fields: [createdById], references: [id])
}

model PointReason {
  id           String              @id @default(uuid())
  name         String              @unique
  description  String?
  isActive     Boolean             @default(true)
  createdAt    DateTime            @default(now())
  updatedAt    DateTime            @updatedAt
  createdById  String
  createdBy    User                @relation("AdminReasons", fields: [createdById], references: [id])
  transactions PointsTransaction[] @relation("ReasonTransactions")
}

model Announcement {
  id          String   @id @default(uuid())
  title       String
  content     String
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  createdById String
  periodId    String
  createdBy   User     @relation("AdminAnnouncements", fields: [createdById], references: [id])
  period      Period   @relation("PeriodAnnouncements", fields: [periodId], references: [id])

  @@index([periodId])
}

model TransactionRollback {
  id              String   @id @default(uuid())
  transactionId   String
  transactionType String
  studentId       String
  adminId         String
  reason          String
  createdAt       DateTime @default(now())
  periodId        String
  admin           User     @relation("RollbackAdmin", fields: [adminId], references: [id])
  period          Period   @relation("PeriodRollbacks", fields: [periodId], references: [id])
  student         User     @relation("RollbackStudent", fields: [studentId], references: [id])

  @@index([periodId])
}

model WeeklyReport {
  id                String                         @id @default(uuid())
  weekNumber        Int
  status            WeeklyReportStatus             @default(DRAFT)
  submissionDate    DateTime?
  reviewDate        DateTime?
  reviewNotes       String?
  createdAt         DateTime                       @default(now())
  updatedAt         DateTime                       @updatedAt
  periodId          String
  userId            String
  reviewedById      String?
  comments          String?
  pointsAwarded     Int                            @default(0)
  period            Period                         @relation("PeriodWeeklyReports", fields: [periodId], references: [id])
  reviewedBy        User?                          @relation("AdminReviewedReports", fields: [reviewedById], references: [id])
  user              User                           @relation("UserWeeklyReports", fields: [userId], references: [id])
  fixedCriteria     WeeklyReportFixedCriteria?
  questionResponses WeeklyReportQuestionResponse[]
  variableCriteria  WeeklyReportVariableCriteria?

  @@unique([userId, periodId, weekNumber])
  @@index([periodId])
  @@index([userId])
  @@index([weekNumber])
}

model WeeklyReportFixedCriteria {
  id                         String            @id @default(uuid())
  reportId                   String            @unique
  weeklyMeeting              AttendanceStatus?
  groupMeeting               AttendanceStatus?
  calledAbsentStudents       AttendanceStatus?
  curriculumEducation        AttendanceStatus?
  groupActivity              AttendanceStatus?
  individualAttention        AttendanceStatus?
  weeklyMeetingAsistan       AttendanceStatus?
  groupMeetingAsistan        AttendanceStatus?
  informationMessages        AttendanceStatus?
  bilgeverseDataEntry        AttendanceStatus?
  groupActivityAsistan       AttendanceStatus?
  individualAttentionAsistan AttendanceStatus?
  workshopParticipation      AttendanceStatus?
  report                     WeeklyReport      @relation(fields: [reportId], references: [id], onDelete: Cascade)
}

model WeeklyReportVariableCriteria {
  id                      String            @id @default(uuid())
  reportId                String            @unique
  internalTraining        AttendanceStatus?
  jointActivityLeadership AttendanceStatus?
  originalActivity        AttendanceStatus?
  parentMeeting           AttendanceStatus?
  report                  WeeklyReport      @relation(fields: [reportId], references: [id], onDelete: Cascade)
}

model WeeklyReportQuestion {
  id          String                         @id @default(uuid())
  text        String
  type        QuestionType
  targetRole  UserRole
  orderIndex  Int
  isActive    Boolean                        @default(true)
  createdAt   DateTime                       @default(now())
  updatedAt   DateTime                       @updatedAt
  createdById String
  createdBy   User                           @relation("AdminQuestions", fields: [createdById], references: [id])
  responses   WeeklyReportQuestionResponse[]

  @@index([type, targetRole, isActive])
  @@index([orderIndex])
}

model WeeklyReportQuestionResponse {
  id         String               @id @default(uuid())
  response   AttendanceStatus
  createdAt  DateTime             @default(now())
  updatedAt  DateTime             @updatedAt
  questionId String
  reportId   String
  question   WeeklyReportQuestion @relation(fields: [questionId], references: [id], onDelete: Cascade)
  report     WeeklyReport         @relation(fields: [reportId], references: [id], onDelete: Cascade)

  @@unique([questionId, reportId])
  @@index([reportId])
}

model PartPdf {
  id           String   @id @default(uuid())
  partId       Int
  title        String
  description  String?
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
  uploadedById String
  driveLink    String
  isActive     Boolean  @default(true)
  contentType  String?
  uploadedBy   User     @relation("UploadedPdfs", fields: [uploadedById], references: [id])

  @@index([partId])
  @@index([uploadedById])
}

model ManagerMeeting {
  id                  String              @id @default(uuid())
  title               String
  description         String?
  meetingDate         DateTime
  location            String
  status              MeetingStatus       @default(PLANNED)
  qrCodeToken         String?             @unique
  qrCodeExpiresAt     DateTime?
  createdAt           DateTime            @default(now())
  updatedAt           DateTime            @updatedAt
  createdById         String
  allowGuestAttendees Boolean             @default(false)
  maxAttendees        Int?
  createdBy           User                @relation("MeetingCreator", fields: [createdById], references: [id])
  attendees           MeetingAttendance[] @relation("MeetingAttendances")
  decisions           MeetingDecision[]   @relation("MeetingDecisions")

  @@index([createdById])
  @@index([meetingDate])
  @@index([status])
}

model MeetingAttendance {
  id            String         @id @default(uuid())
  checkInMethod CheckInMethod
  checkInTime   DateTime       @default(now())
  createdAt     DateTime       @default(now())
  updatedAt     DateTime       @updatedAt
  meetingId     String
  userId        String
  attended      Boolean?
  markedAt      DateTime?
  markedBy      String?
  meeting       ManagerMeeting @relation("MeetingAttendances", fields: [meetingId], references: [id], onDelete: Cascade)
  user          User           @relation("UserAttendances", fields: [userId], references: [id], onDelete: Cascade)

  @@unique([meetingId, userId])
  @@index([meetingId])
  @@index([userId])
}

model MeetingDecision {
  id               String                    @id @default(uuid())
  title            String
  description      String?
  targetDate       DateTime?
  status           DecisionStatus            @default(TODO)
  createdAt        DateTime                  @default(now())
  updatedAt        DateTime                  @updatedAt
  meetingId        String
  responsibleUsers DecisionResponsibleUser[] @relation("DecisionResponsibleUsers")
  meeting          ManagerMeeting            @relation("MeetingDecisions", fields: [meetingId], references: [id], onDelete: Cascade)

  @@index([meetingId])
  @@index([status])
}

model DecisionResponsibleUser {
  id         String          @id @default(uuid())
  decisionId String
  userId     String
  decision   MeetingDecision @relation("DecisionResponsibleUsers", fields: [decisionId], references: [id], onDelete: Cascade)
  user       User            @relation("DecisionResponsible", fields: [userId], references: [id], onDelete: Cascade)

  @@unique([decisionId, userId])
  @@index([decisionId])
  @@index([userId])
}

model BoardMember {
  id        String   @id @default(uuid())
  title     String
  isActive  Boolean  @default(true)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  userId    String   @unique
  user      User     @relation("BoardMemberUser", fields: [userId], references: [id], onDelete: Cascade)

  @@index([isActive])
  @@index([userId])
}

model AttendanceSession {
  id              String                  @id @default(uuid())
  title           String
  description     String?
  sessionDate     DateTime
  qrCodeToken     String?                 @unique
  qrCodeExpiresAt DateTime?
  status          AttendanceSessionStatus @default(PLANNED)
  createdAt       DateTime                @default(now())
  updatedAt       DateTime                @updatedAt
  createdById     String
  createdBy       User                    @relation("SessionCreator", fields: [createdById], references: [id])
  attendances     StudentAttendance[]     @relation("SessionAttendances")

  @@index([createdById])
  @@index([sessionDate])
  @@index([status])
}

model StudentAttendance {
  id            String            @id @default(uuid())
  checkInMethod CheckInMethod
  checkInTime   DateTime          @default(now())
  notes         String?
  createdAt     DateTime          @default(now())
  updatedAt     DateTime          @updatedAt
  sessionId     String
  studentId     String
  session       AttendanceSession @relation("SessionAttendances", fields: [sessionId], references: [id], onDelete: Cascade)
  student       User              @relation("StudentAttendances", fields: [studentId], references: [id], onDelete: Cascade)

  @@unique([sessionId, studentId])
  @@index([sessionId])
  @@index([studentId])
}

model AbsenceNotification {
  id               String   @id @default(uuid())
  weeksMissed      Int
  notificationSent DateTime @default(now())
  createdAt        DateTime @default(now())
  studentId        String
  tutorId          String
  student          User     @relation("StudentAbsenceNotifications", fields: [studentId], references: [id], onDelete: Cascade)
  tutor            User     @relation("TutorAbsenceNotifications", fields: [tutorId], references: [id])

  @@index([studentId])
  @@index([tutorId])
  @@index([notificationSent])
}

model Syllabus {
  id               String                    @id @default(uuid())
  title            String
  description      String?
  shareToken       String?                   @unique
  isPublished      Boolean                   @default(false)
  isGlobal         Boolean                   @default(false)
  createdAt        DateTime                  @default(now())
  updatedAt        DateTime                  @updatedAt
  createdById      String
  driveLink        String?
  feedbackForms    ParentFeedback[]          @relation("SyllabusFeedback")
  createdBy        User                      @relation("TutorSyllabi", fields: [createdById], references: [id])
  lessons          SyllabusLesson[]          @relation("SyllabusLessons")
  classroomProgress ClassroomLessonProgress[] @relation("SyllabusClassroomProgress")

  @@index([createdById])
  @@index([shareToken])
  @@index([isGlobal])
}

model SyllabusLesson {
  id               String                    @id @default(uuid())
  orderIndex       Int
  title            String
  description      String?
  createdAt        DateTime                  @default(now())
  updatedAt        DateTime                  @updatedAt
  syllabusId       String
  driveLink        String?
  syllabus         Syllabus                  @relation("SyllabusLessons", fields: [syllabusId], references: [id], onDelete: Cascade)
  classroomProgress ClassroomLessonProgress[] @relation("LessonClassroomProgress")

  @@index([syllabusId])
  @@index([orderIndex])
}

model ClassroomLessonProgress {
  id          String         @id @default(uuid())
  classroomId String
  syllabusId  String
  lessonId    String
  isTaught    Boolean        @default(false)
  taughtDate  DateTime?
  notes       String?
  createdAt   DateTime       @default(now())
  updatedAt   DateTime       @updatedAt
  classroom   Classroom      @relation("ClassroomLessonProgress", fields: [classroomId], references: [id], onDelete: Cascade)
  syllabus    Syllabus       @relation("SyllabusClassroomProgress", fields: [syllabusId], references: [id], onDelete: Cascade)
  lesson      SyllabusLesson @relation("LessonClassroomProgress", fields: [lessonId], references: [id], onDelete: Cascade)

  @@unique([classroomId, lessonId])
  @@index([classroomId])
  @@index([syllabusId])
  @@index([lessonId])
}

model ParentFeedback {
  id             String          @id @default(uuid())
  parentName     String?
  parentEmail    String?
  overallRating  FeedbackRating?
  contentQuality FeedbackRating?
  effectiveness  FeedbackRating?
  engagement     FeedbackRating?
  createdAt      DateTime        @default(now())
  syllabusId     String
  syllabus       Syllabus        @relation("SyllabusFeedback", fields: [syllabusId], references: [id], onDelete: Cascade)

  @@index([syllabusId])
  @@index([createdAt])
}

model Notification {
  id        String           @id @default(uuid())
  type      NotificationType
  title     String
  message   String
  isRead    Boolean          @default(false)
  createdAt DateTime         @default(now())
  userId    String
  user      User             @relation("UserNotifications", fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([isRead])
  @@index([createdAt])
}

model Part2EventType {
  id          String       @id @default(uuid())
  name        String       @unique
  description String?
  isActive    Boolean      @default(true)
  createdAt   DateTime     @default(now())
  updatedAt   DateTime     @updatedAt
  events      Part2Event[] @relation("Part2EventTypeEvents")

  @@index([isActive])
}

model Part2Event {
  id              String                  @id @default(uuid())
  title           String
  description     String
  eventDate       DateTime
  location        String
  capacity        Int                     @default(30)
  notes           String?
  qrCodeToken     String?                 @unique
  qrCodeExpiresAt DateTime?
  status          Part2EventStatus        @default(YAKINDA)
  createdAt       DateTime                @default(now())
  updatedAt       DateTime                @updatedAt
  eventTypeId     String
  createdById     String
  createdBy       User                    @relation("Part2EventCreator", fields: [createdById], references: [id])
  eventType       Part2EventType          @relation("Part2EventTypeEvents", fields: [eventTypeId], references: [id])
  participants    Part2EventParticipant[] @relation("Part2EventParticipants")

  @@index([eventTypeId])
  @@index([createdById])
  @@index([eventDate])
  @@index([status])
}

model Part2EventParticipant {
  id            String                 @id @default(uuid())
  status        Part2ParticipantStatus @default(REGISTERED)
  checkInMethod CheckInMethod?
  registeredAt  DateTime               @default(now())
  checkInTime   DateTime?
  notes         String?
  updatedAt     DateTime               @updatedAt
  eventId       String
  studentId     String
  event         Part2Event             @relation("Part2EventParticipants", fields: [eventId], references: [id], onDelete: Cascade)
  student       User                   @relation("Part2EventParticipations", fields: [studentId], references: [id], onDelete: Cascade)

  @@unique([eventId, studentId])
  @@index([eventId])
  @@index([studentId])
  @@index([status])
}

enum UserRole {
  ADMIN
  TUTOR
  STUDENT
  ASISTAN
}

enum RequestStatus {
  PENDING
  APPROVED
  REJECTED
}

enum TransactionType {
  AWARD
  REDEEM
}

enum EventStatus {
  YAKINDA
  DEVAM_EDIYOR
  TAMAMLANDI
  IPTAL_EDILDI
}

enum EventScope {
  GLOBAL
  GROUP
}

enum PeriodStatus {
  ACTIVE
  INACTIVE
  ARCHIVED
}

enum ParticipantStatus {
  REGISTERED
  ATTENDED
  ABSENT
}

enum WeeklyReportStatus {
  DRAFT
  SUBMITTED
  APPROVED
  REJECTED
}

enum AttendanceStatus {
  YAPILDI
  YAPILMADI
  YOKTU
}

enum QuestionType {
  FIXED
  VARIABLE
}

enum MeetingStatus {
  PLANNED
  ONGOING
  COMPLETED
  CANCELLED
}

enum CheckInMethod {
  QR
  MANUAL
}

enum DecisionStatus {
  TODO
  IN_PROGRESS
  DONE
}

enum AttendanceSessionStatus {
  PLANNED
  ACTIVE
  COMPLETED
  CANCELLED
}

enum FeedbackRating {
  VERY_POOR
  POOR
  AVERAGE
  GOOD
  EXCELLENT
}

enum NotificationType {
  ABSENCE_ALERT
  SYLLABUS_FEEDBACK
  GENERAL
}

enum Part2EventStatus {
  YAKINDA
  DEVAM_EDIYOR
  TAMAMLANDI
  IPTAL_EDILDI
}

enum Part2ParticipantStatus {
  REGISTERED
  ATTENDED
  ABSENT
}
